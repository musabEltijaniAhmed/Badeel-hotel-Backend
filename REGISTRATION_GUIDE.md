# ๐ฏ ุฏููู ุชูููุฒ ุงููุณุชุฎุฏููู ุฃุซูุงุก ุงูุชุณุฌูู

## ๐ ุฃููุงุน ุงููุณุชุฎุฏููู ุงููุฏุนููุฉ

### 1. **ุงูุนููุงุก (Customers)**
- ุงูุชุณุฌูู **ูุฌุงูู ูููุชูุญ** ููุฌููุน
- **ุงูุฏูุฑ**: `customer` (ID: 1)
- **ุงูุตูุงุญูุงุช**: ุนุฑุถ ุงูุบุฑูุ ุฅูุดุงุก ุญุฌูุฒุงุชุ ุงุณุชุฎุฏุงู ููุจููุงุช

### 2. **ุงูููุธููู (Staff)**
- ุงูุชุณุฌูู **ุจููุฏ ุฏุนูุฉ** ููุท
- **ุงูุฏูุฑ**: `staff` (ID: 3)
- **ุงูุตูุงุญูุงุช**: ุฅุฏุงุฑุฉ ุงูุบุฑูุ ุนุฑุถ ุฌููุน ุงูุญุฌูุฒุงุชุ ุฅุฏุงุฑุฉ ุงูููุจููุงุช

### 3. **ุงููุฏูุฑูู (Admins)**
- ุงูุชุณุฌูู **ุจููุฏ ุฏุนูุฉ ุฎุงุต** ููุท
- **ุงูุฏูุฑ**: `admin` (ID: 2)
- **ุงูุตูุงุญูุงุช**: **ูุงูู ุงูุตูุงุญูุงุช** ูู ุงููุธุงู

---

## ๐ฃ๏ธ ุทุฑู ุงูุชุณุฌูู ุงููุชุงุญุฉ

### **ุงูุทุฑููุฉ 1: ุชุณุฌูู ุงูุนููุงุก**

```bash
# ุงูุชุณุฌูู ุงูุนุงู (ุงูุชุฑุงุถูุงู ููุนููุงุก)
POST /auth/register
```

```json
{
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "phone": "+966501234567",
  "email": "ahmed@example.com",  // ุงุฎุชูุงุฑู
  "password": "123456",
  "language": "ar"              // ุงุฎุชูุงุฑู
}
```

```bash
# ุงูุชุณุฌูู ุงููุงุถุญ ููุนููุงุก
POST /auth/register/customer
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุนููู ุจูุฌุงุญ",
  "data": {
    "user": {
      "id": "user-uuid",
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "phone": "+966501234567",
      "Role": {
        "id": 1,
        "name": "customer",
        "description": "ุนููู - ููููู ุชุตูุญ ุงูููุชุฌุงุช ูุฅูุดุงุก ุงูุทูุจุงุช"
      }
    },
    "token": "jwt-token",
    "userType": "customer"
  }
}
```

---

### **ุงูุทุฑููุฉ 2: ุชุณุฌูู ุงูููุธููู**

```bash
POST /auth/register/staff
```

```json
{
  "name": "ุณุงุฑุฉ ุฃุญูุฏ",
  "phone": "+966507654321",
  "email": "sara@company.com",      // ูุทููุจ ููููุธููู
  "password": "staff123",
  "invitationCode": "ABC12345",     // ูุทููุจ
  "language": "ar"
}
```

---

### **ุงูุทุฑููุฉ 3: ุชุณุฌูู ุงููุฏูุฑูู**

```bash
POST /auth/register/admin
```

```json
{
  "name": "ูุญูุฏ ุงูุฅุฏุงุฑุฉ",
  "phone": "+966509876543",
  "email": "admin@company.com",     // ูุทููุจ ูููุฏูุฑูู
  "password": "admin12345",         // 8 ุฃุญุฑู ุนูู ุงูุฃูู
  "invitationCode": "ADMIN7890",    // ูุทููุจ
  "language": "ar"
}
```

---

## ๐ซ ุฅุฏุงุฑุฉ ุฃููุงุฏ ุงูุฏุนูุฉ

### **ุฅูุดุงุก ููุฏ ุฏุนูุฉ** (ูููุฏูุฑูู ููุท)

```bash
POST /auth/invitation-codes
Authorization: Bearer admin-jwt-token
```

```json
{
  "roleId": 3,              // 2 = admin, 3 = staff
  "expiresInDays": 7        // ุงุฎุชูุงุฑูุ ุงูุชุฑุงุถูุงู ูุง ููุชูู
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุฅูุดุงุก ููุฏ ุงูุฏุนูุฉ ุจูุฌุงุญ",
  "data": {
    "invitationCode": {
      "id": 1,
      "code": "A1B2C3D4",
      "Role": {
        "name": "staff",
        "description": "ููุธู - ูู ุตูุงุญูุงุช ูุญุฏูุฏุฉ ุญุณุจ ุงูููุตุจ"
      },
      "expiresAt": "2024-01-16T10:00:00.000Z"
    },
    "registrationUrl": "http://localhost:3000/auth/register/staff",
    "instructions": "ุงุณุชุฎุฏู ุงูููุฏ \"A1B2C3D4\" ูุน ุฑุงุจุท ุงูุชุณุฌูู ููุฏูุฑ: ููุธู"
  }
}
```

### **ุงูุชุญูู ูู ููุฏ ุงูุฏุนูุฉ**

```bash
POST /auth/validate-invitation
```

```json
{
  "invitationCode": "A1B2C3D4"
}
```

---

## ๐ ุฃูุซูุฉ ุนูููุฉ ููุงุณุชุฎุฏุงู

### **ุณููุงุฑูู 1: ุชุณุฌูู ุนููู ุฌุฏูุฏ**

1. ุงูุนููู ูุฐูุจ ูู `/auth/register`
2. ูููุฃ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
3. ูุตุจุญ **ุนููู** ุชููุงุฆูุงู
4. ููููู ุชุตูุญ ุงูุบุฑู ูุฅูุดุงุก ุญุฌูุฒุงุช

### **ุณููุงุฑูู 2: ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ**

1. **ุงููุฏูุฑ** ููุดุฆ ููุฏ ุฏุนูุฉ ููููุธููู:
   ```bash
   POST /auth/invitation-codes
   { "roleId": 3, "expiresInDays": 30 }
   ```

2. **ุงููุฏูุฑ** ูุฑุณู ุงูููุฏ ููููุธู ุงูุฌุฏูุฏ

3. **ุงูููุธู** ูุณุฌู ุจุงุณุชุฎุฏุงู ุงูููุฏ:
   ```bash
   POST /auth/register/staff
   { ..., "invitationCode": "ABC12345" }
   ```

4. ุงูููุธู ูุตุจุญ ูุฏูู ุตูุงุญูุงุช ุงูู staff

### **ุณููุงุฑูู 3: ุฅุถุงูุฉ ูุฏูุฑ ุฌุฏูุฏ**

1. **ูุฏูุฑ ููุฌูุฏ** ููุดุฆ ููุฏ ุฏุนูุฉ ูููุฏูุฑูู:
   ```bash
   POST /auth/invitation-codes
   { "roleId": 2, "expiresInDays": 7 }
   ```

2. **ุงููุฏูุฑ ุงูุฌุฏูุฏ** ูุณุฌู:
   ```bash
   POST /auth/register/admin
   { ..., "invitationCode": "ADMIN7890" }
   ```

---

## ๐ก๏ธ ุงูุญูุงูุฉ ูุงูุฃูุงู

### **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช**
- ูู API endpoint ูุญูู ุจู **middleware ุตูุงุญูุงุช**
- ุงููุณุชุฎุฏู ูุฌุจ ุฃู ูููู ูู ุงูุตูุงุญูุฉ ุงููุทููุจุฉ

### **ุฃููุงุฏ ุงูุฏุนูุฉ**
- **ุชุณุชุฎุฏู ูุฑุฉ ูุงุญุฏุฉ ููุท**
- ููุง **ุชุงุฑูุฎ ุงูุชูุงุก** (ุงุฎุชูุงุฑู)
- **ูุง ูููู ุฅูุดุงุคูุง** ุฅูุง ูู ุงููุฏูุฑูู
- **ูุฑุชุจุทุฉ ุจุฏูุฑ ูุญุฏุฏ**

### **ูููุงุช ุงููุฑูุฑ**
- ุงูุนููุงุก: **6 ุฃุญุฑู** ุนูู ุงูุฃูู
- ุงูููุธููู: **6 ุฃุญุฑู** ุนูู ุงูุฃูู  
- ุงููุฏูุฑูู: **8 ุฃุญุฑู** ุนูู ุงูุฃูู

---

## ๐ ุฌุฏูู ุงูุตูุงุญูุงุช

| ุงูุนูููุฉ | ุงูุนููุงุก | ุงูููุธููู | ุงููุฏูุฑูู |
|---------|--------|----------|----------|
| ุนุฑุถ ุงูุบุฑู | โ | โ | โ |
| ุฅูุดุงุก ุบุฑูุฉ | โ | โ | โ |
| ุชุนุฏูู ุบุฑูุฉ | โ | โ | โ |
| ุญุฐู ุบุฑูุฉ | โ | โ | โ |
| ุฅูุดุงุก ุญุฌุฒ | โ | โ | โ |
| ุนุฑุถ ุฌููุน ุงูุญุฌูุฒุงุช | โ | โ | โ |
| ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู | โ | โ | โ |
| ุฅูุดุงุก ููุจููุงุช | โ | โ | โ |
| ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ | โ | โ | โ |

---

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

```bash
# ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ
npm run db:reset

# ุงุฎุชุจุงุฑ ูุธุงู ุงูุตูุงุญูุงุช
npm run test:permissions
```

---

## ๐ ุฑูุงุจุท ูููุฏุฉ

- **[ูุงุฆูุฉ ูุงููุฉ ุจุงูู APIs](/api-docs)**
- **[ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](/admin/roles)**
- **[ุฅุฏุงุฑุฉ ุฃููุงุฏ ุงูุฏุนูุฉ](/admin/invitation-codes)**
